SELECT HOUR(FARE.PICKUP_TIME) as Stunde, ROUND(MINUTE(FARE.PICKUP_TIME) / 30, 0 , ROUND_DOWN) as HalbeStd, SUM(FARE.FARE) as Umsatz
FROM NYCCAB.FARE
WHERE WEEKDAY(FARE.PICKUP_TIME) = 1 /* AND HOUR(...) = 19 AND ROUND(...) = 0 */
GROUP BY HOUR(FARE.PICKUP_TIME), ROUND(MINUTE(FARE.PICKUP_TIME) / 30, 0 , ROUND_DOWN)
ORDER BY Stunde, HalbeStd
